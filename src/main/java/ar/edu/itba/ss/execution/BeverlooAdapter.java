package ar.edu.itba.ss.execution;

import ar.edu.itba.ss.algorithm.GranularSystem;
import ar.edu.itba.ss.domain.Silo;
import org.apache.commons.math3.geometry.euclidean.twod.Vector2D;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

import static ar.edu.itba.ss.algorithm.ParticlesCreator.MAX_RADIUS;
import static ar.edu.itba.ss.algorithm.ParticlesCreator.MIN_RADIUS;
import static ar.edu.itba.ss.domain.Particle.G;

public class BeverlooAdapter {

    private double simulationTime;
    private int samples;
    private double bFrom;
    private double bTo;
    private double bStep;

    private Silo room;
    private GranularSystem granularSystem;

    private List<Double> times;
    private List<Double> caudalSimuladoAvg = new ArrayList<>();
    private List<Double> caudalSimuladoMax = new ArrayList<>();
    private List<Double> caudalSimuladoMin = new ArrayList<>();


    private static final double width = .25;
    private static final double exitOpeningSize = width/5;
    private static final double dt = 1e-5;
    private static final long dt2 = (long)1e2;
    private static final int particleNumbers = 400;

    private List<Double> cList = new ArrayList<>();

    public BeverlooAdapter(double simulationTime, int samples, double bFrom, double bTo, double bStep) {
        this.simulationTime = simulationTime;
        this.samples = samples;
        this.bFrom = bFrom;
        this.bTo = bTo;
        this.bStep = bStep;
        initCList();
    }

    private void initCList() {
        for(double c = bFrom; c < bTo ; c+=bStep){
            cList.add(c);
        }
        cList.add(bTo);
    }

    public void startSimulation(){
       List<List<Double>> todosLosCaudales = new ArrayList<>();
       times = Arrays.asList( .9, 1. , 1.1 , 1.2 , 1.3);


       List<Double> npList = new ArrayList<>();
       for(int i=1 ; i <= samples ; i++){
           System.out.println("sample nro "+i);
           room = new Silo(width, 2, exitOpeningSize, .25,0.25);
           granularSystem = new GranularSystem(dt, dt2, simulationTime, room, particleNumbers);
           granularSystem.updateStatisticalValues(times);
           granularSystem.simulate();

           List<Double> caudals = granularSystem.getCaudal().stream().map(Vector2D::getY).collect(Collectors.toList());
           todosLosCaudales.add(caudals);
           npList.addAll(granularSystem.getNpList());

       }

       //armo los puntos avg
        for(int i = 0; i < times.size() ; i++){
           List<Double> tmpList = new ArrayList<>();
           for(List<Double> caudalList: todosLosCaudales){
               tmpList.add(caudalList.get(i));
           }
            caudalSimuladoAvg.add(tmpList.stream().mapToDouble(d->d).average().getAsDouble());
            caudalSimuladoMin.add(tmpList.stream().mapToDouble(d->d).min().getAsDouble());
            caudalSimuladoMax.add(tmpList.stream().mapToDouble(d->d).max().getAsDouble());
        }

        // armo los caudales teoricos por cada time y c
        List<Vector2D> todosLosCaudalesTeoricos = todosLosCaudalesTeoricos( cList, npList);

       List<Vector2D> eCList = todosLosCaudalesTeoricos.stream()
               .map( cT -> new Vector2D(cT.getX(), eC(cT.getY(),caudalSimuladoAvg)))
               .collect(Collectors.toList());


       System.out.println(eCList);
        System.out.println(todosLosCaudalesTeoricos);
        System.out.println(caudalSimuladoAvg);
        System.out.println(caudalSimuladoMin);
        System.out.println(caudalSimuladoMax);



    }

    private double eC(double qT, List<Double> caudalSimuladoAvg) {
        return caudalSimuladoAvg.stream().mapToDouble( qS -> Math.pow(qS - qT, 2)).average().getAsDouble();
    }

    private List<Vector2D> todosLosCaudalesTeoricos(List<Double> cList, List<Double> npList) {
        return cList.stream()
                .map( c -> new Vector2D(c, beverlooCaudal(c, npList)))
                .collect(Collectors.toList());
    }

    public double beverlooCaudal(double c, List<Double> npList){
        double r = (MAX_RADIUS+MIN_RADIUS)/2;
        double d = room.getExitOpeningSize();
        double np = npList.stream().mapToDouble( cnp -> cnp).average().getAsDouble();
        return np*Math.sqrt(G)*Math.pow(d-(c*r), 1.5);
    }

    public static void main(String[] args) {
        BeverlooAdapter adapter = new BeverlooAdapter(1.4, 1, .5,1.5,0.03);
        adapter.startSimulation();
    }
}

/*

[{-300; 1,487,158.2121088728}, {-299; 1,472,286.4541170497}, {-298; 1,457,513.7658762434}, {-297; 1,442,839.8183861542}, {-296; 1,428,264.2826430944}, {-295; 1,413,786.829639963}, {-294; 1,399,407.1303662125}, {-293; 1,385,124.8558078236}, {-292; 1,370,939.676947275}, {-291; 1,356,851.2647635143}, {-290; 1,342,859.2902319264}, {-289; 1,328,963.4243243055}, {-288; 1,315,163.3380088217}, {-287; 1,301,458.7022499957}, {-286; 1,287,849.1880086581}, {-285; 1,274,334.4662419267}, {-284; 1,260,914.2079031698}, {-283; 1,247,588.083941975}, {-282; 1,234,355.7653041135}, {-281; 1,221,216.9229315135}, {-280; 1,208,171.2277622176}, {-279; 1,195,218.3507303572}, {-278; 1,182,357.962766111}, {-277; 1,169,589.7347956744}, {-276; 1,156,913.3377412218}, {-275; 1,144,328.442520873}, {-274; 1,131,834.7200486541}, {-273; 1,119,431.8412344626}, {-272; 1,107,119.47698403}, {-271; 1,094,897.298198884}, {-270; 1,082,764.9757763082}, {-269; 1,070,722.1806093086}, {-268; 1,058,768.5835865675}, {-267; 1,046,903.8555924116}, {-266; 1,035,127.6675067628}, {-265; 1,023,439.6902051063}, {-264; 1,011,839.5945584445}, {-263; 1,000,327.051433255}, {-262; 988,901.7316914514}, {-261; 977,563.3061903365}, {-260; 966,311.4457825621}, {-259; 955,145.8213160846}, {-258; 944,066.1036341169}, {-257; 933,071.9635750891}, {-256; 922,163.0719725961}, {-255; 911,339.0996553574}, {-254; 900,599.7174471657}, {-253; 889,944.5961668415}, {-252; 879,373.4066281837}, {-251; 868,885.8196399199}, {-250; 858,481.506005659}, {-249; 848,160.1365238406}, {-248; 837,921.3819876799}, {-247; 827,764.9131851222}, {-246; 817,690.4008987847}, {-245; 807,697.5159059078}, {-244; 797,785.9289782981}, {-243; 787,955.310882275}, {-242; 778,205.3323786155}, {-241; 768,535.664222496}, {-240; 758,945.9771634388}, {-239; 749,435.9419452504}, {-238; 740,005.2293059649}, {-237; 730,653.5099777842}, {-236; 721,380.4546870168}, {-235; 712,185.7341540174}, {-234; 703,069.0190931247}, {-233; 694,029.9802125966}, {-232; 685,068.2882145487}, {-231; 676,183.6137948865}, {-230; 667,375.6276432425}, {-229; 658,644.0004429069}, {-228; 649,988.4028707597}, {-227; 641,408.5055972036}, {-226; 632,903.9792860914}, {-225; 624,474.4945946576}, {-224; 616,119.7221734438}, {-223; 607,839.3326662264}, {-222; 599,632.9967099434}, {-221; 591,500.3849346153}, {-220; 583,441.1679632734}, {-219; 575,455.0164118778}, {-218; 567,541.6008892388}, {-217; 559,700.5919969387}, {-216; 551,931.6603292475}, {-215; 544,234.4764730416}, {-214; 536,608.7110077195}, {-213; 529,054.0345051138}, {-212; 521,570.1175294081}, {-211; 514,156.6306370447}, {-210; 506,813.2443766372}, {-209; 499,539.6292888784}, {-208; 492,335.4559064467}, {-207; 485,200.3947539132}, {-206; 478,134.1163476439}, {-205; 471,136.2911957043}, {-204; 464,206.5897977583}, {-203; 457,344.6826449683}, {-202; 450,550.2402198928}, {-201; 443,822.932996381}, {-200; 437,162.4314394683}, {-199; 430,568.4060052676}, {-198; 424,040.5271408588}, {-197; 417,578.4652841786}, {-196; 411,181.8908639057}, {-195; 404,850.4742993462}, {-194; 398,583.8860003157}, {-193; 392,381.7963670186}, {-192; 386,243.875789928}, {-191; 380,169.7946496602}, {-190; 374,159.2233168498}, {-189; 368,211.8321520204}, {-188; 362,327.2915054534}, {-187; 356,505.2717170563}, {-186; 350,745.4431162257}, {-185; 345,047.4760217096}, {-184; 339,411.0407414672}, {-183; 333,835.8075725245}, {-182; 328,321.4468008298}, {-181; 322,867.6287011041}, {-180; 317,474.0235366893}, {-179; 312,140.3015593947}, {-178; 306,866.1330093387}, {-177; 301,651.1881147893}, {-176; 296,495.1370920005}, {-175; 291,397.6501450445}, {-174; 286,358.3974656439}, {-173; 281,377.0492329962}, {-172; 276,453.275613599}, {-171; 271,586.7467610691}, {-170; 266,777.1328159581}, {-169; 262,024.1039055663}, {-168; 257,327.3301437502}, {-167; 252,686.4816307285}, {-166; 248,101.2284528823}, {-165; 243,571.2406825516}, {-164; 239,096.1883778291}, {-163; 234,675.741582347}, {-162; 230,309.570325062}, {-161; 225,997.3446200344}, {-160; 221,738.7344662018}, {-159; 217,533.4098471505}, {-158; 213,381.0407308789}, {-157; 209,281.2970695585}, {-156; 205,233.8487992873}, {-155; 201,238.3658398402}, {-154; 197,294.5180944124}, {-153; 193,401.9754493569}, {-152; 189,560.4077739172}, {-151; 185,769.4849199538}, {-150; 182,028.8767216637}, {-149; 178,338.2529952946}, {-148; 174,697.2835388515}, {-147; 171,105.6381317979}, {-146; 167,562.9865347486}, {-145; 164,068.9984891565}, {-144; 160,623.3437169917}, {-143; 157,225.6919204124}, {-142; 153,875.7127814292}, {-141; 150,573.07596156}, {-140; 147,317.4511014778}, {-139; 144,108.5078206495}, {-138; 140,945.9157169652}, {-137; 137,829.3443663593}, {-136; 134,758.4633224223}, {-135; 131,732.9421160018}, {-134; 128,752.4502547945}, {-133; 125,816.6572229277}, {-132; 122,925.2324805297}, {-131; 120,077.8454632896}, {-130; 117,274.1655820053}, {-129; 114,513.8622221205}, {-128; 111,796.6047432482}, {-127; 109,122.0624786831}, {-126; 106,489.9047348999}, {-125; 103,899.8007910386}, {-124; 101,351.4198983758}, {-123; 98,844.4312797813}, {-122; 96,378.5041291605}, {-121; 93,953.3076108802}, {-120; 91,568.5108591793}, {-119; 89,223.7829775627}, {-118; 86,918.7930381776}, {-117; 84,653.2100811722}, {-116; 82,426.7031140364}, {-115; 80,238.9411109218}, {-114; 78,089.593011944}, {-113; 75,978.327722462}, {-112; 73,904.8141123374}, {-111; 71,868.721015171}, {-110; 69,869.7172275164}, {-109; 67,907.4715080689}, {-108; 65,981.6525768299}, {-107; 64,091.9291142452}, {-106; 62,237.9697603159}, {-105; 60,419.4431136811}, {-104; 58,636.0177306718}, {-103; 56,887.3621243333}, {-102; 55,173.1447634164}, {-101; 53,493.0340713348}, {-100; 51,846.6984250887}, {-99; 50,233.806154151}, {-98; 48,654.0255393172}, {-97; 47,107.0248115143}, {-96; 45,592.4721505702}, {-95; 44,110.0356839387}, {-94; 42,659.3834853807}, {-93; 41,240.1835735974}, {-92; 39,852.1039108149}, {-91; 38,494.8124013174}, {-90; 37,167.9768899262}, {-89; 35,871.2651604222}, {-88; 34,604.3449339093}, {-87; 33,366.8838671157}, {-86; 32,158.5495506302}, {-85; 30,979.0095070699}, {-84; 29,827.9311891757}, {-83; 28,704.9819778331}, {-82; 27,609.8291800127}, {-81; 26,542.1400266279}, {-80; 25,501.5816703041}, {-79; 24,487.8211830551}, {-78; 23,500.5255538627}, {-77; 22,539.3616861521}, {-76; 21,603.9963951593}, {-75; 20,694.0964051836}, {-74; 19,809.3283467183}, {-73; 18,949.3587534539}, {-72; 18,113.8540591441}, {-71; 17,302.4805943296}, {-70; 16,514.9045829082}, {-69; 15,750.7921385439}, {-68; 15,009.8092609039}, {-67; 14,291.6218317137}, {-66; 13,595.8956106183}, {-65; 12,922.2962308368}, {-64; 12,270.4891945979}, {-63; 11,640.1398683406}, {-62; 11,030.9134776659}, {-61; 10,442.4751020211}, {-60; 9,874.4896690989}, {-59; 9,326.6219489319}, {-58; 8,798.5365476596}, {-57; 8,289.8979009451}, {-56; 7,800.3702670158}, {-55; 7,329.6177192993}, {-54; 6,877.3041386243}, {-53; 6,443.093204953}, {-52; 6,026.6483886076}, {-51; 5,627.6329409508}, {-50; 5,245.7098844761}, {-49; 4,880.5420022578}, {-48; 4,531.7918267084}, {-47; 4,199.1216275816}, {-46; 3,882.1933991564}, {-45; 3,580.6688465282}, {-44; 3,294.2093709247}, {-43; 3,022.4760539571}, {-42; 2,765.1296407034}, {-41; 2,521.8305215117}, {-40; 2,292.2387123949}, {-39; 2,076.0138338741}, {-38; 1,872.8150881092}, {-37; 1,682.3012341341}, {-36; 1,504.130560989}, {-35; 1,337.9608585161}, {-34; 1,183.4493855483}, {-33; 1,040.2528351863}, {-32; 908.0272968107}, {-31; 786.4282144235}, {-30; 675.1103408508}, {-29; 573.7276872617}, {-28; 481.933467369}, {-27; 399.3800355689}, {-26; 325.7188181469}, {-25; 260.6002365146}, {-24; 203.6736212535}, {-23; 154.5871154965}, {-22; 112.9875658847}, {-21; 78.5203989673}, {-20; 50.8294804447}, {-19; 29.5569540658}, {-18; 14.3430562338}, {-17; 4.8259013981}, {-16; 0.6412320297}, {-15; 1.422125292}, {-14; 6.7986462537}, {-13; 16.3974344228}, {-12; 29.8412061464}, {-11; 46.7481494885}, {-10; 66.7311797197}, {-9; 89.3970111821}, {-8; 114.3449828147}, {-7; 141.1655462477}, {-6; 169.438280453}, {-5; 198.7292231814}, {-4; 228.5871831097}, {-3; 258.5384690497}, {-2; 288.0790364867}, {-1; 316.6621490449}, {0; 343.6775882294}, {1; 368.4130417807}, {2; 389.9710775714}, {3; 407.038658489}, {4; 416.528}, {5; (NaN)}]

[{-300; 1,239.8908134582}, {-299; 1,233.7779650698}, {-298; 1,227.6751955856}, {-297; 1,221.5825216786}, {-296; 1,215.4999601051}, {-295; 1,209.4275277049}, {-294; 1,203.3652414024}, {-293; 1,197.313118207}, {-292; 1,191.2711752141}, {-291; 1,185.2394296054}, {-290; 1,179.2178986501}, {-289; 1,173.2065997054}, {-288; 1,167.2055502171}, {-287; 1,161.2147677209}, {-286; 1,155.2342698424}, {-285; 1,149.2640742986}, {-284; 1,143.3041988982}, {-283; 1,137.3546615427}, {-282; 1,131.415480227}, {-281; 1,125.4866730404}, {-280; 1,119.5682581672}, {-279; 1,113.6602538876}, {-278; 1,107.7626785788}, {-277; 1,101.8755507156}, {-276; 1,095.9988888713}, {-275; 1,090.1327117186}, {-274; 1,084.2770380305}, {-273; 1,078.4318866813}, {-272; 1,072.5972766473}, {-271; 1,066.7732270079}, {-270; 1,060.9597569464}, {-269; 1,055.1568857511}, {-268; 1,049.3646328162}, {-267; 1,043.5830176427}, {-266; 1,037.8120598395}, {-265; 1,032.0517791242}, {-264; 1,026.3021953244}, {-263; 1,020.5633283785}, {-262; 1,014.835198337}, {-261; 1,009.1178253629}, {-260; 1,003.4112297337}, {-259; 997.7154318418}, {-258; 992.0304521957}, {-257; 986.3563114215}, {-256; 980.6930302635}, {-255; 975.0406295855}, {-254; 969.3991303722}, {-253; 963.7685537301}, {-252; 958.1489208888}, {-251; 952.5402532022}, {-250; 946.9425721496}, {-249; 941.3558993371}, {-248; 935.7802564987}, {-247; 930.2156654978}, {-246; 924.662148328}, {-245; 919.1197271151}, {-244; 913.5884241179}, {-243; 908.0682617297}, {-242; 902.5592624796}, {-241; 897.0614490341}, {-240; 891.574844198}, {-239; 886.0994709166}, {-238; 880.6353522763}, {-237; 875.1825115067}, {-236; 869.7409719818}, {-235; 864.3107572214}, {-234; 858.8918908929}, {-233; 853.4843968126}, {-232; 848.0882989475}, {-231; 842.7036214166}, {-230; 837.330388493}, {-229; 831.9686246048}, {-228; 826.6183543376}, {-227; 821.2796024355}, {-226; 815.9523938033}, {-225; 810.6367535079}, {-224; 805.3327067803}, {-223; 800.0402790173}, {-222; 794.7594957834}, {-221; 789.4903828125}, {-220; 784.2329660098}, {-219; 778.9872714539}, {-218; 773.7533253987}, {-217; 768.5311542751}, {-216; 763.3207846933}, {-215; 758.1222434447}, {-214; 752.935557504}, {-213; 747.7607540314}, {-212; 742.5978603744}, {-211; 737.4469040705}, {-210; 732.3079128487}, {-209; 727.1809146326}, {-208; 722.0659375418}, {-207; 716.963009895}, {-206; 711.8721602116}, {-205; 706.7934172147}, {-204; 701.7268098334}, {-203; 696.6723672049}, {-202; 691.6301186776}, {-201; 686.6000938129}, {-200; 681.5823223888}, {-199; 676.5768344016}, {-198; 671.583660069}, {-197; 666.602829833}, {-196; 661.6343743624}, {-195; 656.6783245557}, {-194; 651.734711544}, {-193; 646.803566694}, {-192; 641.8849216111}, {-191; 636.9788081419}, {-190; 632.0852583779}, {-189; 627.2043046584}, {-188; 622.3359795738}, {-187; 617.4803159685}, {-186; 612.6373469448}, {-185; 607.8071058659}, {-184; 602.9896263593}, {-183; 598.1849423207}, {-182; 593.3930879171}, {-181; 588.614097591}, {-180; 583.8480060633}, {-179; 579.094848338}, {-178; 574.3546597054}, {-177; 569.6274757464}, {-176; 564.9133323363}, {-175; 560.2122656489}, {-174; 555.5243121609}, {-173; 550.8495086556}, {-172; 546.187892228}, {-171; 541.5395002886}, {-170; 536.9043705681}, {-169; 532.282541122}, {-168; 527.6740503355}, {-167; 523.0789369277}, {-166; 518.4972399571}, {-165; 513.9289988264}, {-164; 509.3742532873}, {-163; 504.833043446}, {-162; 500.3054097685}, {-161; 495.7913930858}, {-160; 491.2910345995}, {-159; 486.8043758877}, {-158; 482.3314589102}, {-157; 477.872326015}, {-156; 473.4270199439}, {-155; 468.995583839}, {-154; 464.5780612484}, {-153; 460.1744961334}, {-152; 455.7849328743}, {-151; 451.4094162776}, {-150; 447.0479915828}, {-149; 442.7007044693}, {-148; 438.3676010636}, {-147; 434.0487279465}, {-146; 429.7441321611}, {-145; 425.4538612199}, {-144; 421.177963113}, {-143; 416.916486316}, {-142; 412.6694797986}, {-141; 408.4369930323}, {-140; 404.219076}, {-139; 400.015779204}, {-138; 395.8271536756}, {-137; 391.6532509842}, {-136; 387.4941232469}, {-135; 383.3498231381}, {-134; 379.2204038998}, {-133; 375.1059193514}, {-132; 371.0064239008}, {-131; 366.9219725548}, {-130; 362.8526209303}, {-129; 358.7984252654}, {-128; 354.7594424317}, {-127; 350.7357299456}, {-126; 346.7273459808}, {-125; 342.7343493813}, {-124; 338.7567996735}, {-123; 334.7947570806}, {-122; 330.8482825354}, {-121; 326.9174376946}, {-120; 323.0022849537}, {-119; 319.102887461}, {-118; 315.2193091339}, {-117; 311.3516146736}, {-116; 307.4998695821}, {-115; 303.6641401782}, {-114; 299.8444936154}, {-113; 296.0409978985}, {-112; 292.2537219027}, {-111; 288.4827353918}, {-110; 284.7281090378}, {-109; 280.9899144404}, {-108; 277.2682241478}, {-107; 273.5631116775}, {-106; 269.8746515386}, {-105; 266.2029192538}, {-104; 262.5479913827}, {-103; 258.909945546}, {-102; 255.2888604498}, {-101; 251.6848159118}, {-100; 248.0978928868}, {-99; 244.5281734949}, {-98; 240.975741049}, {-97; 237.4406800844}, {-96; 233.9230763889}, {-95; 230.4230170337}, {-94; 226.9405904063}, {-93; 223.4758862435}, {-92; 220.0289956665}, {-91; 216.6000112164}, {-90; 213.1890268919}, {-89; 209.7961381877}, {-88; 206.4214421348}, {-87; 203.0650373419}, {-86; 199.7270240388}, {-85; 196.4075041215}, {-84; 193.1065811982}, {-83; 189.8243606387}, {-82; 186.5609496242}, {-81; 183.3164572001}, {-80; 180.0909943306}, {-79; 176.8846739558}, {-78; 173.6976110507}, {-77; 170.5299226875}, {-76; 167.3817280996}, {-75; 164.2531487496}, {-74; 161.144308399}, {-73; 158.055333182}, {-72; 154.9863516823}, {-71; 151.9374950131}, {-70; 148.9088969018}, {-69; 145.9006937771}, {-68; 142.9130248623}, {-67; 139.9460322709}, {-66; 136.9998611089}, {-65; 134.0746595809}, {-64; 131.170579102}, {-63; 128.2877744155}, {-62; 125.4264037167}, {-61; 122.5866287829}, {-60; 119.7686151111}, {-59; 116.9725320623}, {-58; 114.1985530147}, {-57; 111.4468555248}, {-56; 108.7176214977}, {-55; 106.0110373684}, {-54; 103.3272942922}, {-53; 100.6665883475}, {-52; 98.0291207512}, {-51; 95.4150980867}, {-50; 92.8247325468}, {-49; 90.2582421927}, {-48; 87.7158512292}, {-47; 85.1977902986}, {-46; 82.7042967953}, {-45; 80.2356152014}, {-44; 77.7919974467}, {-43; 75.3737032949}, {-42; 72.9810007579}, {-41; 70.614166542}, {-40; 68.2734865285}, {-39; 65.9592562919}, {-38; 63.6717816609}, {-37; 61.4113793249}, {-36; 59.178377493}, {-35; 56.9731166093}, {-34; 54.7959501329}, {-33; 52.6472453891}, {-32; 50.5273845}, {-31; 48.4367654059}, {-30; 46.3758029876}, {-29; 44.344930304}, {-28; 42.3445999592}, {-27; 40.3752856192}, {-26; 38.4374836978}, {-25; 36.5317152378}, {-24; 34.6585280185}, {-23; 32.8184989228}, {-22; 31.0122366109}, {-21; 29.2403845486}, {-20; 27.5036244583}, {-19; 25.8026802668}, {-18; 24.1383226498}, {-17; 22.5113742913}, {-16; 20.9227160125}, {-15; 19.3732939603}, {-14; 17.8641281078}, {-13; 16.3963223878}, {-12; 14.9710768889}, {-11; 13.5897026872}, {-10; 12.2536400939}, {-9; 10.9644814036}, {-8; 9.7239996808}, {-7; 8.5341858161}, {-6; 7.3972971866}, {-5; 6.3159230625}, {-4; 5.2930749949}, {-3; 4.3323160023}, {-2; 3.4379530573}, {-1; 2.6153395016}, {0; 1.8713846111}, {1; 1.2154999601}, {2; 0.6616343744}, {3; 0.2339230764}, {4; 0}, {5; (NaN)}]

        [20.2, 19.4, 21.2, 20.4, 20.8]*/
